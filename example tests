import styles from '../styles/Home.module.css'
import type { NextPage } from 'next'
import {Assets as Asst, Address,ConstrData, HeliosData,AssetClass,Cip30Handle, Cip30Wallet,
  HInt, ByteArrayData, hexToBytes, WalletHelper, NetworkParams, Value,
TxOutput,Tx, MintingPolicyHash,BlockfrostV0, 
Token} from '@hyperionbt/helios'
import { useState, useEffect, FocusEvent, MouseEvent } from "react";

import {opt,jtest,jtrics,o,tS,tE } from 'jimba';
opt._O = 0;
opt._FailsOnly = 0;
opt._T = 0;
opt._M = 0;
opt._R = 0;
opt._F = 1;

import { BrowserWallet,MaestroProvider,Transaction,Asset } from '@meshsdk/core';
import { walletHandleNami } from './nami';

declare global {
   interface Window {
    cardano : any
   }
}

const Home : NextPage = () => {

  const optimize = false; 
  const networkParamsUrl = "https://d1t0d7c2nekuk0.cloudfront.net/preprod.json"; o({networkParamsUrl})
  const [walletAPI, setWalletAPI] = useState<undefined | any>(undefined); 
  const [walletHelper, setWalletHelper] = useState<undefined | any>(undefined);
  const [walletHandleNami,setWalletHandleNami] = useState<undefined|any>();
  const [address, setAddress] = useState('');
  const [tx, setTx] = useState({ txId : '' });
  const [ada,setAda] = useState("")
  const [tokens,setTokens] = useState('')
  const [utxos,setUtxos] = useState('')
  const [assetTotal, setAssetTotal] = useState(0)
  const [networkType, setNetworkType] = useState(0)
  const [problem,setProblem] = useState(false)
  const [collateral,setCollateral] = useState("")
  const [unusedAddresses,getUnusedAddresses] = useState("")
  const [name, setName] = useState('Event Tickets');
  const currentDate = new Date(new Date().getTime() + 24 * 60 * 60 * 1000); o({currentDate})
  const day = currentDate.getDate() ;o({day})
  const month = currentDate.getMonth() + 1 ;o({month})
  const year = currentDate.getFullYear() ;o({year})
  const tomorrowDate = day + "-" + month + "-" + year ; o({tomorrowDate})
  const [description, setDescription] = useState('Welcome to our beautiful event taking place as from '+tomorrowDate);
  const [img, setImg] = useState('https://www.freepik.com/free-psd/saturday-party-social-media-template_34657531.htm#fromView=search&page=1&position=41&uuid=9b9e87f2-df93-44a1-ac1e-51f64bd0c220');  

    const assetsDisplayString = (assetsAsStringArray:[]|any)=>{
      tS('assetsDisplayString'); o({assetsAsStringArray})
      const assets = JSON.stringify(assetsAsStringArray).split('},') ; o({assets});jtest("assets",Array.isArray(assets), true)
      assetsAsStringArray = assets; 
      let hReadableAssests = '';
      const totalAssets = assetsAsStringArray.length;o({totalAssets});jtest("totalAssets length of elem 1 = 1",totalAssets,1);
      for(let i = 0; i < totalAssets; i ++)
      {
        
        const data = assetsAsStringArray[i].replace(/{/g,'').replace(/}/g,'').replace('','').split(":"); o({data});jtest("data",data[4].length,4)
        if(data[0]=='') {return "No assets found on this UTXO "};
        const tokenNameLength = data[1].length; o({tokenNameLength});
        if(tokenNameLength > 24)
        {         
          const tempName = "NFT Name : \t\t" + data[3].split(",")[0] + "\r\nQty : \t\t\t" + data[4] + 
          "\r\nPolicyId : \t\t" + data[0] + "\r\nAsset Name Encoded : \t" + data[1]; o({tempName});
          const tempName_ = tempName.replace(/"/g,''); o({tempName_});
          hReadableAssests += "\r\n\r\n"+tempName_ 
        }
        else
        {
          const tempName = "Token Name : \t\t" + data[3].split(",")[0] + "\r\nQty : \t\t\t" + data[4] + 
          "\r\nPolicyId : \t\t" + data[0] + "\r\nAsset Name Encoded : \t" + data[1]; o({tempName});
          const tempName_ = tempName.replace(/"/g,'');o({tempName_});
          hReadableAssests += "\r\n\r\n"+tempName_;
        }   
      }

      tE("assetsDisplayString");

      jtrics()

      return hReadableAssests ;
  }

console outputs:


j.js:63 {hReadableAssests: '\r\n\r\nToken Name : \t\tVesting Key\r\nQty : \t\t\t1\r\nPolicy…92a\r\nAsset Name Encoded : \t56657374696e67204b6579'}
j.js:56 ✓ PASS 
j.js:63 {mph: MintingPolicyHash}
j.js:323 3 :  : TESTING address
j.js:358 ✓ PASS : 108
j.js:323 4 :  : TESTING ada
j.js:365 X FAIL : Am expecting 9 but got 8
j.js:323 5 :  : TESTING walletAPI
j.js:347 X FAIL : Am expecting b49258f836a82c98bf16af444da88e11a40a9eb623345a053d87a885aa8a3008 but got ca812e7b7ce9941a4e500484d6dc493b784b1fb89ccfb71d10e9ff2272472f56
j.js:323 6 :  : TESTING walletHelper
j.js:347 X FAIL : Am expecting addr_test1qz0hzxlrw5lwspvc9gpqll3ujpxyjmd5uylwqe8xdlt5d82ktxgu9qsyjahc67r53404t42p44vxv8hwhpdscw9l58jqktkm74 but got addr_test1qplmwkeprxsr32apq0mmddhs8la4a8556zss36te7h98ch0t0d9az20lyrcsm6za3gk4e6eefpy0w22745tvlw648pcs5m67rw
j.js:323 7 :  : TESTING walletHandleNami
j.js:412 ✓ PASS : [object Object]
j.js:149 TOTAL_PASSES : 60
j.js:139 TOTAL_ERRORS : 6
j.js:159 TOTAL_FUNCTIONS : 2
j.js:161 {assetsDisplayString: 2}
j.js:173 TOTAL_TESTS_PASS : 4
j.js:177 TOTAL_TESTS_FAIL : 4
j.js:181 TOTAL_TESTS_RUN : 24
